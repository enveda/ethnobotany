high = "blue",
na.value = NA,
name="Normalized\nIndication\nCount")
png("phylo_heatmap.png",width=960,height=960)
p1
dev.off()
source("~/Documents/project_directories/team_advanced_analytics/ethnobotany/phylo_heatmap.R")
library("ggtree")
library("ggplot2")
library("dplyr")
library("sjstats")
setwd("/Users/danielence/Documents/project_directories/team_advanced_analytics/ethnobotany/")
#df <- read.table("family_indication_count.tsv",sep="\t",header=TRUE,row.names = 1)
df <- read.table("family_indication_count_normalized.tsv",sep="\t",header=TRUE,row.names = 1)
tree <- read.tree("np_family_tree.nwk")
circ <- ggtree(tree, layout = "circular") + geom_tiplab()
#rownames(df) <- tree$tip.label
png("phylo.png")
circ
dev.off()
p1 <- gheatmap(circ, df, offset=.8, width=.2,
colnames_angle = 95, colnames_offset_y = .25,
font.size=6, legend_title="Normalized Indication Count") +
scale_fill_gradient(low = "lightblue",
high = "blue",
na.value = NA,
name="Normalized\nIndication\nCount")
png("phylo_heatmap.png",width=960,height=960)
p1
dev.off()
View(df)
source("~/Documents/project_directories/team_advanced_analytics/ethnobotany/phylo_heatmap.R")
library("ggtree")
library("ggplot2")
library("dplyr")
library("sjstats")
setwd("/Users/danielence/Documents/project_directories/team_advanced_analytics/ethnobotany/")
#df <- read.table("family_indication_count.tsv",sep="\t",header=TRUE,row.names = 1)
df <- read.table("family_indication_count_normalized.tsv",sep="\t",header=TRUE,row.names = 1)
tree <- read.tree("np_family_tree.nwk")
circ <- ggtree(tree, layout = "circular") + geom_tiplab()
#rownames(df) <- tree$tip.label
png("phylo.png")
circ
dev.off()
df1 <- df %>% select(auditory.system.disorder,
breast.disorder,
cancer.or.benign.tumor,
cardiovascular.disorder,
connective.tissue.disorder)
df2 <- df %>% select(digestive.system.disorder,
disorder.of.visual.system,
endocrine.system.disorder,
hematologic.disorder,)
df3 <- df %>% select(immune.system.disorder,
inflammatory.disease,
injury,
integumentary.system.disorder,
infectious.disease.or.post.infectious.disorder,)
df3 <- df %>% select(metabolic.disease,
musculoskeletal.system.disorder,
nervous.system.disorder,
nutritional.disorder,)
df4 <- df %>% select(otorhinolaryngologic.disease,
poisoning,
psychiatric.disorder,
respiratory.system.disorder,
urinary.system.disorder,)
dim(normed_df)
p1 <- gheatmap(circ, df1, offset=.8, width=.2,
colnames_angle = 95, colnames_offset_y = .25,
font.size=6, legend_title="Normalized Indication Count") +
scale_fill_gradient(low = "lightblue",
high = "blue",
na.value = NA,
name="Normalized\nIndication\nCount")
png("phylo_heatmap.png",width=960,height=960)
p1
dev.off()
source("~/Documents/project_directories/team_advanced_analytics/ethnobotany/phylo_heatmap.R")
library("ggtree")
library("ggplot2")
library("dplyr")
library("sjstats")
setwd("/Users/danielence/Documents/project_directories/team_advanced_analytics/ethnobotany/")
#df <- read.table("family_indication_count.tsv",sep="\t",header=TRUE,row.names = 1)
df <- read.table("family_indication_count_normalized.tsv",sep="\t",header=TRUE,row.names = 1)
tree <- read.tree("np_family_tree.nwk")
circ <- ggtree(tree, layout = "circular") + geom_tiplab()
#rownames(df) <- tree$tip.label
png("phylo.png")
circ
dev.off()
df1 <- df %>% select(auditory.system.disorder,
breast.disorder,)
#df1 <- df %>% select(auditory.system.disorder,
#                     breast.disorder,
#                     cancer.or.benign.tumor,
#                     cardiovascular.disorder,
#                     connective.tissue.disorder)
df2 <- df %>% select(digestive.system.disorder,
disorder.of.visual.system,
endocrine.system.disorder,
hematologic.disorder,)
df3 <- df %>% select(immune.system.disorder,
inflammatory.disease,
injury,
integumentary.system.disorder,
infectious.disease.or.post.infectious.disorder,)
df3 <- df %>% select(metabolic.disease,
musculoskeletal.system.disorder,
nervous.system.disorder,
nutritional.disorder,)
df4 <- df %>% select(otorhinolaryngologic.disease,
poisoning,
psychiatric.disorder,
respiratory.system.disorder,
urinary.system.disorder,)
dim(normed_df)
p1 <- gheatmap(circ, df1, offset=.8, width=.2,
colnames_angle = 95, colnames_offset_y = .25,
font.size=6, legend_title="Normalized Indication Count") +
scale_fill_gradient(low = "lightblue",
high = "blue",
na.value = NA,
name="Normalized\nIndication\nCount")
png("phylo_heatmap.png",width=960,height=960)
p1
dev.off()
View(df)
source("~/Documents/project_directories/team_advanced_analytics/ethnobotany/phylo_heatmap.R")
library("ggtree")
library("ggplot2")
library("dplyr")
library("sjstats")
setwd("/Users/danielence/Documents/project_directories/team_advanced_analytics/ethnobotany/")
#df <- read.table("family_indication_count.tsv",sep="\t",header=TRUE,row.names = 1)
df <- read.table("family_indication_count_normalized.tsv",sep="\t",header=TRUE,row.names = 1)
tree <- read.tree("np_family_tree.nwk")
circ <- ggtree(tree, layout = "circular") + geom_tiplab()
#rownames(df) <- tree$tip.label
png("phylo.png")
circ
dev.off()
normed_df$names <- row.names(df)
subset(normed_df, names %in% tree$tip.label)
dim(normed_df)
normed_df <- normed_df %>% select(-names)
normed_df <- normed_df %>% select(auditory.system.disorder,breast.disorder)
dim(normed_df)
p1 <- gheatmap(circ, normed_df, offset=.8, width=.2,
colnames_angle = 95, colnames_offset_y = .25,
font.size=6, legend_title="Normalized Indication Count")# +
scale_fill_gradient(low = "grey",
high = "red",
na.value = NA,
name="Normalized\nIndication\nCount")
png("phylo_heatmap.png",width=960,height=960)
p1
dev.off()
source("~/Documents/project_directories/team_advanced_analytics/ethnobotany/phylo_heatmap.R")
library("ggtree")
library("ggplot2")
library("dplyr")
library("sjstats")
setwd("/Users/danielence/Documents/project_directories/team_advanced_analytics/ethnobotany/")
#df <- read.table("family_indication_count.tsv",sep="\t",header=TRUE,row.names = 1)
df <- read.table("family_indication_count_normalized.tsv",sep="\t",header=TRUE,row.names = 1)
tree <- read.tree("np_family_tree.nwk")
circ <- ggtree(tree, layout = "circular") + geom_tiplab()
#rownames(df) <- tree$tip.label
png("phylo.png")
circ
dev.off()
normed_df$names <- row.names(df)
subset(normed_df, names %in% tree$tip.label)
dim(normed_df)
normed_df <- normed_df %>% select(-names)
normed_df <- normed_df %>% select(auditory.system.disorder,breast.disorder)
dim(normed_df)
p1 <- gheatmap(circ, normed_df, offset=.8, width=.2,
colnames_angle = 95, colnames_offset_y = .25,
font.size=6, legend_title="Normalized Indication Count") +
scale_fill_gradient(low = "grey",
high = "red",
na.value = NA,
name="Normalized\nIndication\nCount")
png("phylo_heatmap.png",width=960,height=960)
p1
dev.off()
source("~/Documents/project_directories/team_advanced_analytics/ethnobotany/phylo_heatmap.R")
library("ggtree")
library("ggplot2")
library("dplyr")
library("sjstats")
setwd("/Users/danielence/Documents/project_directories/team_advanced_analytics/ethnobotany/")
#df <- read.table("family_indication_count.tsv",sep="\t",header=TRUE,row.names = 1)
df <- read.table("family_indication_count_normalized.tsv",sep="\t",header=TRUE,row.names = 1)
tree <- read.tree("np_family_tree.nwk")
circ <- ggtree(tree, layout = "circular") + geom_tiplab()
#rownames(df) <- tree$tip.label
png("phylo.png")
circ
dev.off()
normed_df$names <- row.names(df)
subset(normed_df, names %in% tree$tip.label)
dim(normed_df)
normed_df <- normed_df %>% select(-names)
normed_df <- normed_df %>% select(auditory.system.disorder,breast.disorder)
dim(normed_df)
p1 <- gheatmap(circ, normed_df, offset=.8, width=.2,
colnames_angle = 95, colnames_offset_y = .25,
font.size=6, legend_title="Normalized Indication Count") +
scale_fill_gradient(low = "lightblue",
high = "blue",
na.value = NA,
name="Normalized\nIndication\nCount")
png("phylo_heatmap.png",width=960,height=960)
p1
dev.off()
View(circ)
View(df)
View(tree)
source("~/Documents/project_directories/team_advanced_analytics/ethnobotany/phylo_heatmap.R")
library("ggtree")
library("ggplot2")
library("dplyr")
library("sjstats")
setwd("/Users/danielence/Documents/project_directories/team_advanced_analytics/ethnobotany/")
tree <- read.tree("np_family_tree.nwk")
circ <- ggtree(tree, layout = "circular") + geom_tiplab()
#rownames(df) <- tree$tip.label
png("phylo.png")
circ
dev.off()
df <- read.table("family_indication_count_normalized.tsv",sep="\t",header=TRUE,row.names = 1)
df$labels <- rownames(df)
tree2 <- full_join(tree,df,by="label")
source("~/Documents/project_directories/team_advanced_analytics/ethnobotany/phylo_heatmap.R")
library("ggtree")
library("ggplot2")
library("dplyr")
library("sjstats")
setwd("/Users/danielence/Documents/project_directories/team_advanced_analytics/ethnobotany/")
tree <- read.tree("np_family_tree.nwk")
circ <- ggtree(tree, layout = "circular") + geom_tiplab()
#rownames(df) <- tree$tip.label
png("phylo.png")
circ
dev.off()
df <- read.table("family_indication_count_normalized.tsv",sep="\t",header=TRUE,row.names = 1)
df$labels <- rownames(df)
tree2 <- full_join(tree,df,by="label")
circ2 <- ggtree(tree2,layout="circular") + geom_tiplab()
png("phylo2.png")
circ2
dev.off()
library("ggtree")
library("ggplot2")
library("dplyr")
library("sjstats")
setwd("/Users/danielence/Documents/project_directories/team_advanced_analytics/ethnobotany/")
tree <- read.tree("np_family_tree.nwk")
circ <- ggtree(tree, layout = "circular") + geom_tiplab()
#rownames(df) <- tree$tip.label
png("phylo.png")
circ
dev.off()
df <- read.table("family_indication_count_normalized.tsv",sep="\t",header=TRUE,row.names = 1)
df$labels <- rownames(df)
tree2 <- full_join(tree,df,by="label")
circ2 <- ggtree(tree2,layout="circular") + geom_tiplab()
png("phylo2.png")
circ2
dev.off()
circ2
library("ggtree")
library("ggplot2")
library("dplyr")
library("sjstats")
setwd("/Users/danielence/Documents/project_directories/team_advanced_analytics/ethnobotany/")
tree <- read.tree("np_family_tree.nwk")
circ <- ggtree(tree, layout = "circular") + geom_tiplab()
#rownames(df) <- tree$tip.label
png("phylo.png")
circ
dev.off()
df <- read.table("family_indication_count_normalized.tsv",sep="\t",header=TRUE,row.names = 1)
df$labels <- rownames(df)
tree2 <- full_join(tree,df,by="label")
circ2 <- ggtree(tree2,layout="circular") + geom_tiplab()
png("phylo2.png")
circ2
dev.off()
View(tree)
install.packages("fs")
BiocManager::install()
BiocManager::install("YuLab-SMU/treedataverse")
BiocManager::install("remotes")
BiocManager::install("YuLab-SMU/treedataverse")
source("~/Documents/project_directories/team_advanced_analytics/ethnobotany/treedata-book_example.R")
library(ggtree)
library(ggtree)
## example tree from https://support.bioconductor.org/p/72398/
tree <- read.tree(text= paste("(Organism1.006G249400.1:0.03977,",
"(Organism2.022118m:0.01337,(Organism3.J34265.1:0.00284,",
"Organism4.G02633.1:0.00468)0.51:0.0104):0.02469);"))
p <- ggtree(tree) + geom_tiplab()
source("~/Documents/project_directories/team_advanced_analytics/ethnobotany/treedata-book_example.R", echo=TRUE)
BiocManager::install("treeio")
BiocManager::install("treeio",force=TRUE)
source("~/Documents/project_directories/team_advanced_analytics/ethnobotany/treedata-book_example.R", echo=TRUE)
source("~/Documents/project_directories/team_advanced_analytics/ethnobotany/treedata-book_example.R", echo=TRUE)
source("~/Documents/project_directories/team_advanced_analytics/ethnobotany/treedata-book_example.R", echo=TRUE)
source("~/Documents/project_directories/team_advanced_analytics/ethnobotany/treedata-book_example.R", echo=TRUE)
source("~/Documents/project_directories/team_advanced_analytics/ethnobotany/treedata-book_example.R", echo=TRUE)
library(ggtree)
## example tree from https://support.bioconductor.org/p/72398/
tree <- read.tree(text= paste("(Organism1.006G249400.1:0.03977,",
"(Organism2.022118m:0.01337,(Organism3.J34265.1:0.00284,",
"Organism4.G02633.1:0.00468)0.51:0.0104):0.02469);"))
p <- ggtree(tree) + geom_tiplab()
tree <- read.tree(text = "((A, B), (C, D));")
d <- data.frame(label = LETTERS[1:4],
label2 = c("sunflower", "tree", "snail", "mushroom"))
## rename_taxa use 1st column as key and 2nd column as value by default
## rename_taxa(tree, d)
rename_taxa(tree, d, label, label2) %>% write.tree
source("~/Documents/project_directories/team_advanced_analytics/ethnobotany/treedata-book_example.R")
source("~/Documents/project_directories/team_advanced_analytics/ethnobotany/treedata-book_example.R")
library(ggtree)
library(treeio)
## example tree from https://support.bioconductor.org/p/72398/
tree <- read.tree(text= paste("(Organism1.006G249400.1:0.03977,",
"(Organism2.022118m:0.01337,(Organism3.J34265.1:0.00284,",
"Organism4.G02633.1:0.00468)0.51:0.0104):0.02469);"))
p <- ggtree(tree) + geom_tiplab()
tree <- read.tree(text = "((A, B), (C, D));")
d <- data.frame(label = LETTERS[1:4],
label2 = c("sunflower", "tree", "snail", "mushroom"))
## rename_taxa use 1st column as key and 2nd column as value by default
## rename_taxa(tree, d)
rename_taxa(tree, d, label, label2) %>% write.tree
tree2 <- full_join(tree, d, by = "label")
tree2
source("~/Documents/project_directories/team_advanced_analytics/ethnobotany/phylo_heatmap.R")
library("ggtree")
library("ggplot2")
library("dplyr")
library("sjstats")
setwd("/Users/danielence/Documents/project_directories/team_advanced_analytics/ethnobotany/")
tree <- read.tree("np_family_tree.nwk")
circ <- ggtree(tree, layout = "circular") + geom_tiplab(aes(label=))
#rownames(df) <- tree$tip.label
png("phylo.png")
circ
dev.off()
df <- read.table("family_indication_count_normalized.tsv",sep="\t",header=TRUE,row.names = 1)
df$labels <- rownames(df)
tree2 <- full_join(tree,df,by="label")
circ2 <- ggtree(tree2,layout="circular") + geom_tiplab()
png("phylo2.png")
circ2
source("~/Documents/project_directories/team_advanced_analytics/ethnobotany/phylo_heatmap.R")
library("ggtree")
library("ggplot2")
library("dplyr")
library("sjstats")
setwd("/Users/danielence/Documents/project_directories/team_advanced_analytics/ethnobotany/")
tree <- read.tree("np_family_tree.nwk")
circ <- ggtree(tree, layout = "circular") + geom_tiplab(aes(label=))
#rownames(df) <- tree$tip.label
png("phylo.png")
circ
dev.off()
df <- read.table("family_indication_count_normalized.tsv",sep="\t",header=TRUE,row.names = 1)
df$label <- rownames(df)
tree2 <- full_join(tree,df,by="label")
circ2 <- ggtree(tree2,layout="circular") + geom_tiplab()
png("phylo2.png")
circ2
dev.off()
View(df)
source("~/Documents/project_directories/team_advanced_analytics/ethnobotany/phylo_heatmap.R")
library("ggtree")
library("treeio")
library("ggplot2")
library("dplyr")
library("sjstats")
setwd("/Users/danielence/Documents/project_directories/team_advanced_analytics/ethnobotany/")
tree <- read.tree("np_family_tree.nwk")
circ <- ggtree(tree, layout = "circular") + geom_tiplab()
#rownames(df) <- tree$tip.label
png("phylo.png")
circ
dev.off()
source("~/Documents/project_directories/team_advanced_analytics/ethnobotany/simple_circ_plot.R")
source("~/Documents/project_directories/team_advanced_analytics/ethnobotany/simple_circ_plot.R")
library("ggtree")
library("treeio")
library("ggplot2")
library("dplyr")
library("sjstats")
setwd("/Users/danielence/Documents/project_directories/team_advanced_analytics/ethnobotany/")
tree <- read.tree("np_family_tree.nwk")
circ <- ggtree(tree, layout = "circular") + geom_tiplab(size=3, color="black")
#rownames(df) <- tree$tip.label
#quartz.save("phylo.png")
png("phylo.png")
circ
dev.off()
library("ggtree")
library("treeio")
library("ggplot2")
library("dplyr")
library("sjstats")
setwd("/Users/danielence/Documents/project_directories/team_advanced_analytics/ethnobotany/")
tree <- read.tree("np_family_tree.nwk")
circ <- ggtree(tree, layout = "circular") + geom_tiplab(aes(angle=angle),size=3, color="black")
#rownames(df) <- tree$tip.label
#quartz.save("phylo.png")
png("phylo.png")
circ
dev.off()
library("ggtree")
library("treeio")
library("ggplot2")
library("dplyr")
library("sjstats")
setwd("/Users/danielence/Documents/project_directories/team_advanced_analytics/ethnobotany/")
tree <- read.tree("np_family_tree.nwk")
circ <- ggtree(tree, layout = "circular") + geom_tiplab(aes(angle=angle),size=3, color="black")
#rownames(df) <- tree$tip.label
#quartz.save("phylo.png")
png("phylo.png")
circ
dev.off()
library("ggtree")
library("treeio")
library("ggplot2")
library("dplyr")
library("sjstats")
setwd("/Users/danielence/Documents/project_directories/team_advanced_analytics/ethnobotany/")
tree <- read.tree("np_family_tree.nwk")
circ <- ggtree(tree, layout = "circular") + geom_tiplab(aes(angle=angle),size=3, color="black")
#rownames(df) <- tree$tip.label
#quartz.save("phylo.png")
png("phylo.png",width=960,height=960)
circ
dev.off()
help(geom_tiplab)
help(geom)tiplab2)
help(geom_tiplab2)
library("ggtree")
library("treeio")
library("ggplot2")
library("dplyr")
library("sjstats")
setwd("/Users/danielence/Documents/project_directories/team_advanced_analytics/ethnobotany/")
tree <- read.tree("np_family_tree.nwk")
circ <- ggtree(tree, layout = "circular") + geom_tiplab(size=3, color="black")
png("phylo.png",width=960,height=960)
circ
dev.off()
library("ggtree")
library("treeio")
library("ggplot2")
library("dplyr")
library("sjstats")
setwd("/Users/danielence/Documents/project_directories/team_advanced_analytics/ethnobotany/")
tree <- read.tree("np_family_tree.nwk")
circ <- ggtree(tree, layout = "circular") + geom_tiplab(color="black")
png("phylo.png",width=960,height=960)
circ
dev.off()
circ <- ggtree(tree)
png("phylo.png",width=960,height=960)
circ
dev.off()
library("ggtree")
library("treeio")
library("ggplot2")
library("dplyr")
library("sjstats")
setwd("/Users/danielence/Documents/project_directories/team_advanced_analytics/ethnobotany/")
tree <- read.tree("np_family_tree.nwk")
circ <- ggtree(tree)
png("phylo.png",width=960,height=960)
circ
dev.off()
library("ggtree")
library("treeio")
library("ggplot2")
library("dplyr")
library("sjstats")
setwd("/Users/danielence/Documents/project_directories/team_advanced_analytics/ethnobotany/")
tree <- read.tree("np_family_tree.nwk")
circ <- ggtree(tree) + geom_tiplab()
png("phylo.png",width=960,height=960)
circ
dev.off()
library("ggtree")
setwd("/Users/danielence/Documents/project_directories/team_advanced_analytics/ethnobotany/")
tree <- read.tree("np_family_tree.nwk")
circ <- ggtree(tree) + geom_tiplab()
png("phylo.png",width=960,height=960)
circ
dev.off()
circ <- ggtree(tree,layout = "circular") + geom_tiplab()
png("phylo.png",width=960,height=960)
circ
dev.off()
